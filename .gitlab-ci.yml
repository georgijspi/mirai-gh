stages:
  - test

variables:
  # Disable production optimizations for tests
  NODE_ENV: test
  # Disable database connections for backend tests
  DB_SKIP_CONNECTION: "true"

cache:
  key: 
    prefix: ${CI_COMMIT_REF_SLUG}
  paths:
    - src/frontend/mirai-ui/node_modules/
    - src/backend/.venv/

# Include the backend tests configuration
include:
  - local: src/backend/tests/backend-tests.yml

# For backwards compatibility - use the included file instead
backend-test:
  extends: backend-unit-tests
  rules:
    - changes:
        - src/backend/**/*.py 